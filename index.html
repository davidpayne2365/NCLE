<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NCLE Contact Lens Exam Quiz</title>
  <style>
    :root {
      --primary-color: #1a5f7a;
      --secondary-color: #57c4e5;
      --accent-color: #d1f1fa;
      --text-color: #333;
      --background-color: #f9feff;
      --neutral-color: #f0f0f0;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    body { background-color: var(--background-color); color: var(--text-color); line-height: 1.6; padding: 10px; max-width:100%; margin:0 auto; font-size:16px; display:flex; flex-direction:column; min-height:100vh; }
    h1 { font-size:1.5rem; margin-bottom:10px; color:var(--primary-color); text-align:center; }

    .quiz-container { background-color:white; border-radius:8px; padding:16px; margin-top:10px; box-shadow:0 2px 4px rgba(0,0,0,0.1); flex:1; display:flex; flex-direction:column; }
    #quiz-screen { flex:1; display:flex; flex-direction:column; }
    #results-screen { flex:1; display:none; flex-direction:column; }

    .question-container { margin-bottom:10px; padding:12px; border-radius:8px; background-color:var(--accent-color); flex:1; overflow-y:auto; }
    .question { font-weight:bold; margin-bottom:8px; }
    .options { list-style:none; padding:0; }
    .option { background:white; border:1px solid #ddd; border-radius:4px; padding:12px; margin-bottom:8px; cursor:pointer; transition:background-color .3s; }
    .option:hover { background:#f5f5f5; }
    .option.correct { background:var(--primary-color); color:white; }
    .option.incorrect { background:#f44336; color:white; }

    .explanation { margin-top:8px; padding:8px; border-radius:8px; background-color:var(--neutral-color); display:none; max-height:100px; overflow-y:auto; }
    .explanation.show { display:block; }

    .buttons { display:flex; justify-content:space-between; margin-top:12px; }
    button { padding:12px; border:none; border-radius:4px; background:var(--primary-color); color:white; font-size:1rem; cursor:pointer; transition:background-color .3s; flex:1; margin:0 4px; }
    button:hover { background:var(--secondary-color); }
    button:disabled { background:#cccccc; cursor:not-allowed; }

    @media (max-width:600px) {
      body { padding:5px; }
      .quiz-container { padding:12px; }
      h1 { font-size:1.8rem; }
      .option, button { font-size:1.1rem; padding:14px; }
    }
  </style>
</head>
<body>
  <h1>NCLE Contact Lens Exam Quiz</h1>
  <main>
    <div class="quiz-container">
      <div id="quiz-screen">
        <div class="question-container">
          <p class="question" id="question-text"></p>
          <ul class="options" id="options-list"></ul>
          <div class="explanation" id="explanation-box"><h3>Explanation:</h3><p id="explanation-text"></p></div>
        </div>
        <div class="buttons">
          <button id="prev-btn" disabled>Previous</button>
          <button id="next-btn" disabled>Next</button>
        </div>
      </div>
      <div id="results-screen">
        <h2>Quiz Complete</h2>
        <p>Thanks for completing the quiz!</p>
        <div class="buttons">
          <button id="restart-btn">Try Again</button>
        </div>
      </div>
    </div>
  </main>

  <script src="quiz-questions.js"></script>
  <script>
    let questions = [], currentQuestionIndex = 0, selectedOption = null, answeredQuestions = [];
    const quizScreen = document.getElementById('quiz-screen');
    const resultsScreen = document.getElementById('results-screen');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const restartBtn = document.getElementById('restart-btn');
    const questionText = document.getElementById('question-text');
    const optionsList = document.getElementById('options-list');
    const explanationBox = document.getElementById('explanation-box');
    const explanationText = document.getElementById('explanation-text');

    prevBtn.addEventListener('click', showPreviousQuestion);
    nextBtn.addEventListener('click', showNextQuestion);
    restartBtn.addEventListener('click', restartQuiz);

    // Initialize quiz on load
    document.addEventListener('DOMContentLoaded', () => startQuiz());

    function startQuiz() {
      questions = getRandomQuestions(quizQuestions, 25);
      currentQuestionIndex = 0;
      answeredQuestions = Array(questions.length).fill(false);
      quizScreen.style.display = 'flex';
      resultsScreen.style.display = 'none';
      loadQuestion();
    }

    function loadQuestion() {
      const q = questions[currentQuestionIndex];
      questionText.textContent = q.question;
      optionsList.innerHTML = '';
      q.options.forEach((opt,i) => {
        const li = document.createElement('li'); li.className='option'; li.textContent=opt; li.dataset.index=i;
        if(answeredQuestions[currentQuestionIndex]){
          if(i===q.answer) li.classList.add('correct');
          else if(i===selectedOption) li.classList.add('incorrect');
        } else li.addEventListener('click', handleOptionClick);
        optionsList.appendChild(li);
      });
      explanationBox.classList.toggle('show', answeredQuestions[currentQuestionIndex]);
      nextBtn.disabled = !answeredQuestions[currentQuestionIndex];
      prevBtn.disabled = currentQuestionIndex===0;
      nextBtn.textContent = currentQuestionIndex===questions.length-1?'Finish Quiz':'Next';
    }

    function handleOptionClick(e) {
      if(answeredQuestions[currentQuestionIndex]) return;
      selectedOption = +e.target.dataset.index;
      answeredQuestions[currentQuestionIndex] = true;
      const correct = questions[currentQuestionIndex].answer;
      document.querySelectorAll('.option').forEach((opt,idx)=>{
        opt.removeEventListener('click',handleOptionClick);
        if(idx===correct) opt.classList.add('correct');
        else if(idx===selectedOption) opt.classList.add('incorrect');
      });
      explanationText.textContent = questions[currentQuestionIndex].explanation;
      explanationBox.classList.add('show');
      nextBtn.disabled=false;
    }

    function showPreviousQuestion() {
      if(currentQuestionIndex>0){currentQuestionIndex--; loadQuestion();}
    }

    function showNextQuestion() {
      if(currentQuestionIndex<questions.length-1){currentQuestionIndex++; loadQuestion();}
      else{ quizScreen.style.display='none'; resultsScreen.style.display='flex'; }
    }

    function restartQuiz() {
      startQuiz();
    }

    function getRandomQuestions(arr,count){
      const copy=[...arr]; for(let i=copy.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[copy[i],copy[j]]=[copy[j],copy[i]];} return copy.slice(0,count);
    }
  </script>
</body>
</html>
