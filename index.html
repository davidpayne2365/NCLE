<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NCLE Contact Lens Exam Quiz</title>
  <style>
    :root {
      --primary-color: #1a5f7a;
      --secondary-color: #57c4e5;
      --accent-color: #d1f1fa;
      --text-color: #333;
      --background-color: #f9feff;
      --neutral-color: #f0f0f0;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    html, body { height: 100%; }
    body { background-color: var(--background-color); color: var(--text-color); line-height: 1.6; padding: 10px; display: flex; flex-direction: column; }
    h1 { font-size: 1.5rem; margin-bottom: 10px; color: var(--primary-color); text-align: center; }

    .quiz-container { background: white; border-radius: 8px; padding: 16px; margin: 10px auto; box-shadow: 0 2px 4px rgba(0,0,0,0.1); flex: 1; max-width: 500px; display: flex; flex-direction: column; }
    .question-container, .explanation-container { flex: 1; display: flex; flex-direction: column; justify-content: flex-start; }
    .question-container { padding: 12px; background: var(--accent-color); border-radius: 8px; }
    .question { font-weight: bold; margin-bottom: 12px; }
    .options { list-style: none; padding: 0; flex: 1; overflow: auto; }
    .option { background: white; border: 1px solid #ddd; border-radius: 4px; padding: 12px; margin-bottom: 8px; cursor: pointer; transition: background-color .3s; }
    .option:hover { background: #f5f5f5; }
    .option.correct { background: var(--primary-color); color: white; }
    .option.incorrect { background: #f44336; color: white; }

    .explanation-container { display: none; padding: 12px; background: var(--neutral-color); border-radius: 8px; }
    .explanation-container h3 { margin: 8px 0; color: var(--primary-color); }
    .explanation-container .correct-answer { font-weight: bold; margin-bottom: 12px; }

    .buttons { display: flex; justify-content: space-between; margin-top: 12px; }
    button { padding: 12px; border: none; border-radius: 4px; background: var(--primary-color); color: white; font-size: 1rem; cursor: pointer; transition: background-color .3s; flex: 1; margin: 0 4px; }
    button:hover { background: var(--secondary-color); }
    button:disabled { background: #cccccc; cursor: not-allowed; }

    #results-screen { display: none; text-align: center; margin-top: 20px; }
    #results-screen h2 { margin-bottom: 10px; }

    @media (max-width: 600px) {
      .quiz-container { margin: 5px; padding: 12px; }
      h1 { font-size: 1.8rem; }
      .option, button { font-size: 1.1rem; padding: 14px; }
    }
  </style>
</head>
<body>
  <h1>NCLE Contact Lens Exam Quiz</h1>
  <main style="flex:1; display:flex; flex-direction:column;">
    <div class="quiz-container" id="quiz-container">
      <div class="question-container" id="question-container">
        <p class="question" id="question-text"></p>
        <ul class="options" id="options-list"></ul>
      </div>
      <div class="explanation-container" id="explanation-container">
        <div class="correct-answer" id="correct-answer"></div>
        <h3>Explanation:</h3>
        <p id="explanation-text"></p>
      </div>
      <div class="buttons">
        <button id="prev-btn" disabled>Previous</button>
        <button id="next-btn" disabled>Next</button>
      </div>
      <div id="results-screen">
        <h2>Quiz Complete</h2>
        <p>You've completed all questions correctly!</p>
        <button id="restart-btn">Restart Quiz</button>
      </div>
    </div>
  </main>

  <script src="quiz-questions.js"></script>
  <script>
    let questions = [];
    let currentQuestionIndex = 0;
    let selectedOption = null;
    let isFailed = false;

    const questionContainer = document.getElementById('question-container');
    const explanationContainer = document.getElementById('explanation-container');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const restartBtn = document.getElementById('restart-btn');
    const questionText = document.getElementById('question-text');
    const optionsList = document.getElementById('options-list');
    const explanationText = document.getElementById('explanation-text');
    const correctAnswerDiv = document.getElementById('correct-answer');
    const resultsScreen = document.getElementById('results-screen');

    prevBtn.addEventListener('click', () => {
      loadQuestion();
    });

    nextBtn.addEventListener('click', () => {
      if (isFailed) {
        startQuiz();
      } else if (currentQuestionIndex < questions.length - 1) {
        currentQuestionIndex++;
        loadQuestion();
      } else {
        questionContainer.style.display = 'none';
        explanationContainer.style.display = 'none';
        document.getElementById('results-screen').style.display = 'block';
      }
    });

    restartBtn.addEventListener('click', () => {
      startQuiz();
    });

    document.addEventListener('DOMContentLoaded', startQuiz);

    function startQuiz() {
      questions = quizQuestions.slice();
      currentQuestionIndex = 0;
      loadQuestion();
      resultsScreen.style.display = 'none';
    }

    function loadQuestion() {
      const q = questions[currentQuestionIndex];
      questionText.textContent = q.question;
      optionsList.innerHTML = '';
      questionContainer.style.display = 'flex';
      explanationContainer.style.display = 'none';
      prevBtn.disabled = true;
      nextBtn.disabled = true;
      isFailed = false;

      q.options.forEach((opt, i) => {
        const li = document.createElement('li');
        li.className = 'option';
        li.textContent = opt;
        li.dataset.index = i;
        li.addEventListener('click', handleOptionClick);
        optionsList.appendChild(li);
      });
    }

    function handleOptionClick(e) {
      selectedOption = +e.target.dataset.index;
      const q = questions[currentQuestionIndex];
      const correctIndex = q.answer;
      isFailed = selectedOption !== correctIndex;

      document.querySelectorAll('.option').forEach((opt, idx) => {
        opt.removeEventListener('click', handleOptionClick);
        if (idx === correctIndex) opt.classList.add('correct');
        else if (idx === selectedOption) opt.classList.add('incorrect');
      });

      correctAnswerDiv.textContent = 'Correct Answer: ' + q.options[correctIndex];
      explanationText.textContent = q.explanation;
      questionContainer.style.display = 'none';
      explanationContainer.style.display = 'flex';

      nextBtn.textContent = isFailed ? 'Restart Quiz' : (currentQuestionIndex < questions.length - 1 ? 'Next Question' : 'Finish Quiz');
      nextBtn.disabled = false;
    }
  </script>
</body>
</html>
